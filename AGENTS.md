# Shared Agent Guidelines

This is the source of truth for all AI agents (Claude, Gemini, etc.) working on this project.

## Workflow Preferences
- **One Step at a Time:** Perform a single logical task, then stop and ask for validation/feedback. Do not chain multiple feature implementations or fixes together.
- **Validation First:** Always reflect on the current state and plan before executing.
- **User Control:**
    - **Never** start the dev server (`org-blog.dev-server/start-server`) automatically.
    - **Tailwind rebuild (non-watch):** Run only when explicitly instructed, and ask for confirmation before executing.
    - **Never** run Tailwind in watch mode (`tailwindcss ... --watch`) automatically.
    - **Never** modify content in `posts/` or `pages/` unless explicitly asked.
    - **Reminder:** If asked to rebuild Tailwind CSS, remind the user about watch mode for ongoing changes.
- **Roadmap Driven:** Keep `roadmap/index.md` current and follow the one-work-unit rules in `roadmap/README.md`.

## Development Context
- **Tooling:** Clojure CLI (`clj`/`clojure`) with `deps.edn`, Pandoc for Markdown conversion, Tailwind CSS standalone binary (not npm).
- **Generated Files:** `static/` is generated output from `posts/` and `pages/`. `static/css/output.css` is generated by Tailwind. These files are published, so regenerate only when needed.
- **Deprecated Scripts:** `validate-env.sh` and `dev/codex_init.clj` are legacy Codex web scripts. Do not use unless explicitly requested.

## Content Conventions
- **Series guidance:** Follow `content-spec.md` for series purpose, tone, title formats, tags, and filename rules.

## Tech Stack
- **Language:** Clojure 1.10+
- **Templates:** Hiccup
- **Markdown:** Pandoc pipeline
- **Styling:** Tailwind CSS (standalone CLI)
- **E2E/Visual:** Playwright (TypeScript) in `e2e/` folder
- **Task Runner:** `just`
- **Hosting:** Digital Ocean App Platform serves `static/`

## Allowed Verification Commands
The agent **IS** permitted to run these commands when needed:

| Command | Description |
|---------|-------------|
| `just build` | Regenerates all static site output. |
| `just smoke` | Runs basic Playwright smoke tests. |
| `just flow-nav` | Runs navigation flow and captures screenshots. |
| `just screenshot <path>` | Captures a screenshot of a specific route. |

## User-Only Commands
The agent must **NOT** run these unless explicitly instructed:

| Command | Description |
|---------|-------------|
| `just dev` | Starts server and tailwind watcher (concurrent). |
| `just server` | Starts the dev server (port 8081). |
| `just watch-css` | Starts Tailwind in watch mode. |
